<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ATK FRUIT & VEG - Management System</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f6; padding: 20px; color: #333; }
        .header { display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 25px; background: white; padding: 15px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .logo-img { height: 70px; width: auto; }
        .header-text h1 { margin: 0; color: #1b5e20; font-size: 22px; }
        
        .main-container { max-width: 1200px; margin: auto; display: flex; gap: 20px; flex-wrap: wrap; }
        .sidebar { flex: 1; min-width: 380px; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .display-area { flex: 2; min-width: 500px; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        
        h2 { font-size: 12px; text-transform: uppercase; color: #2e7d32; border-bottom: 2px solid #e8f5e9; padding-bottom: 5px; margin-top: 20px; }
        .input-box { margin-bottom: 10px; }
        label { display: block; font-size: 11px; font-weight: bold; color: #555; margin-bottom: 3px; }
        input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
        
        .summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 15px; }
        .box { padding: 12px; border-radius: 8px; text-align: center; color: white; font-weight: bold; font-size: 13px; }
        .sale-box { background: #4caf50; grid-column: span 4; font-size: 1.1rem; }
        .sav-box { background: #fbc02d; color: #333; }
        .exp-box { background: #f44336; }
        .csh-box { background: #fb8c00; }
        .sm-box { background: #2196f3; }

        .p-table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 11px; }
        .p-table th, .p-table td { padding: 8px; border: 1px solid #eee; text-align: center; }
        .p-table th { background: #f8fafc; }
        
        .btn { border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 10px; transition: 0.2s; width: 100%; }
        .btn-save { background: #2e7d32; color: white; font-size: 15px; }
        .btn-download { background: #0288d1; color: white; margin-top: 20px; }
        .btn-delete { background: #ff5252; color: white; padding: 4px 8px; font-size: 10px; border-radius: 4px; width: auto; margin: 0; }
        .btn:hover { opacity: 0.9; transform: scale(1.01); }
        
        .history-section { width: 100%; background: white; margin-top: 20px; padding: 20px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
    </style>
</head>
<body>

<div class="header">
    <img src="logo.png" alt="ATK Logo" class="logo-img">
    <div class="header-text">
        <h1>ATK FRUIT & VEG</h1>
        <p>Accounting & Credit Management System</p>
    </div>
</div>

<div class="main-container">
    <div class="sidebar">
        <h2>1. Daily Totals</h2>
        <div class="input-box"><label>Date</label><input type="date" id="dateInput"></div>
        <div class="input-box"><label>Total Sale Today</label><input type="number" id="s" placeholder="0.00"></div>

        <h2>2. Sales Distribution</h2>
        <div class="input-box"><label>To Savings</label><input type="number" id="tsav" placeholder="0.00"></div>
        <div class="input-box"><label>To Expense</label><input type="number" id="texp" placeholder="0.00"></div>
        <div class="input-box"><label>To Cash</label><input type="number" id="tcsh" placeholder="0.00"></div>

        <h2>3. Stock Purchase Credit</h2>
        <div class="input-box"><label>FRUIT (Old | Bill | Paid)</label>
            <div style="display:flex; gap:2px;"><input type="number" id="of" placeholder="O"><input type="number" id="bf" placeholder="B"><input type="number" id="pf" placeholder="P"></div>
        </div>
        <div class="input-box"><label>VEG (Old | Bill | Paid)</label>
            <div style="display:flex; gap:2px;"><input type="number" id="ov" placeholder="O"><input type="number" id="bv" placeholder="B"><input type="number" id="pv" placeholder="P"></div>
        </div>
        <div class="input-box"><label>BANANA (Old | Bill | Paid)</label>
            <div style="display:flex; gap:2px;"><input type="number" id="ob" placeholder="O"><input type="number" id="bb" placeholder="B"><input type="number" id="pb" placeholder="P"></div>
        </div>
        
        <button class="btn btn-save" onclick="addEntry()">SAVE & RECORD ENTRY</button>
    </div>

    <div class="display-area">
        <h2>Today's Live Summary</h2>
        <div class="summary-grid" id="liveSummary">
            <div class="box sale-box">SALE: 0.00</div>
            <div class="box sav-box">SAVINGS: 0.00</div>
            <div class="box exp-box">EXPENSE: 0.00</div>
            <div class="box csh-box">CASH: 0.00</div>
            <div class="box sm-box">SM CREDIT: 0.00</div>
        </div>

        <h2>Current Stock Balances</h2>
        <table class="p-table">
            <thead><tr><th>Category</th><th>Old</th><th>Bill</th><th>Paid</th><th>Balance</th></tr></thead>
            <tbody id="liveStock">
                <tr><td>Fruit</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td></tr>
                <tr><td>Veg</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td></tr>
                <tr><td>Banana</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td></tr>
            </tbody>
        </table>
        
        <button class="btn btn-download" onclick="downloadCSV()">DOWNLOAD ALL DATA (.CSV)</button>
    </div>

    <div class="history-section">
        <h2>History Log (Delete mistakes here)</h2>
        <table class="p-table" id="historyTable">
            <thead>
                <tr>
                    <th>Date</th><th>Sale</th><th>Sav</th><th>Exp</th><th>Cash</th><th>SM Cred</th><th>Fruit</th><th>Veg</th><th>Ban</th><th>Action</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<script>
    document.getElementById('dateInput').valueAsDate = new Date();
    let shopData = JSON.parse(localStorage.getItem('atk_records')) || [];

    function addEntry() {
        const d = document.getElementById('dateInput').value;
        const s = parseFloat(document.getElementById('s').value) || 0;
        const tsav = parseFloat(document.getElementById('tsav').value) || 0;
        const texp = parseFloat(document.getElementById('texp').value) || 0;
        const tcsh = parseFloat(document.getElementById('tcsh').value) || 0;
        const tsm = s - tsav - texp - tcsh;

        const getP = (p) => {
            const o = parseFloat(document.getElementById('o'+p).value) || 0;
            const b = parseFloat(document.getElementById('b'+p).value) || 0;
            const pd = parseFloat(document.getElementById('p'+p).value) || 0;
            return { o, b, pd, n: (o+b-pd) };
        };

        const f = getP('f'), v = getP('v'), b = getP('b');

        const newRecord = { id: Date.now(), d, s, tsav, texp, tcsh, tsm, fn: f.n, vn: v.n, bn: b.n, fo: f.o, fb: f.b, fp: f.pd, vo: v.o, vb: v.b, vp: v.pd, bo: b.o, bb: b.b, bp: b.pd };
        
        shopData.push(newRecord);
        localStorage.setItem('atk_records', JSON.stringify(shopData));
        
        updateUI(newRecord);
        renderHistory();
        // Clear fields
        ['s','tsav','texp','tcsh','of','bf','pf','ov','bv','pv','ob','bb','pb'].forEach(id => document.getElementById(id).value = '');
    }

    function updateUI(rec) {
        document.getElementById('liveSummary').innerHTML = `
            <div class="box sale-box">SALE: ${rec.s.toFixed(2)}</div>
            <div class="box sav-box">SAVINGS: ${rec.tsav.toFixed(2)}</div>
            <div class="box exp-box">EXPENSE: ${rec.texp.toFixed(2)}</div>
            <div class="box csh-box">CASH: ${rec.tcsh.toFixed(2)}</div>
            <div class="box sm-box">SM CREDIT: ${rec.tsm.toFixed(2)}</div>
        `;
        document.getElementById('liveStock').innerHTML = `
            <tr><td>Fruit</td><td>${rec.fo.toFixed(2)}</td><td>${rec.fb.toFixed(2)}</td><td>${rec.fp.toFixed(2)}</td><td><strong>${rec.fn.toFixed(2)}</strong></td></tr>
            <tr><td>Veg</td><td>${rec.vo.toFixed(2)}</td><td>${rec.vb.toFixed(2)}</td><td>${rec.vp.toFixed(2)}</td><td><strong>${rec.vn.toFixed(2)}</strong></td></tr>
            <tr><td>Banana</td><td>${rec.bo.toFixed(2)}</td><td>${rec.bb.toFixed(2)}</td><td>${rec.bp.toFixed(2)}</td><td><strong>${rec.bn.toFixed(2)}</strong></td></tr>
        `;
    }

    function renderHistory() {
        const tbody = document.querySelector('#historyTable tbody');
        tbody.innerHTML = shopData.slice().reverse().map(item => `
            <tr>
                <td>${item.d}</td><td>${item.s.toFixed(2)}</td><td>${item.tsav.toFixed(2)}</td><td>${item.texp.toFixed(2)}</td>
                <td>${item.tcsh.toFixed(2)}</td><td>${item.tsm.toFixed(2)}</td><td>${item.fn.toFixed(2)}</td><td>${item.vn.toFixed(2)}</td><td>${item.bn.toFixed(2)}</td>
                <td><button class="btn btn-delete" onclick="deleteItem(${item.id})">Delete</button></td>
            </tr>
        `).join('');
    }

    function deleteItem(id) {
        if(confirm("Are you sure you want to delete this entry?")) {
            shopData = shopData.filter(item => item.id !== id);
            localStorage.setItem('atk_records', JSON.stringify(shopData));
            renderHistory();
        }
    }

    function downloadCSV() {
        let csv = "Date,Sale,Savings,Expense,Cash,SM Credit,Fruit Bal,Veg Bal,Banana Bal\n";
        shopData.forEach(i => {
            csv += `${i.d},${i.s},${i.tsav},${i.texp},${i.tcsh},${i.tsm},${i.fn},${i.vn},${i.bn}\n`;
        });
        const blob = new Blob([csv], { type: 'text/csv' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.setAttribute('href', url);
        a.setAttribute('download', 'ATK_Shop_Data.csv');
        a.click();
    }

    renderHistory();
</script>

</body>
</html>